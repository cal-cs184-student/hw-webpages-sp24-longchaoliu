<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c6{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c10{color:#434343;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:15pt;font-family:"Arial";font-style:normal}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c15{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c14{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-family:"Arial"}.c7{color:#000000;text-decoration:none;vertical-align:baseline;font-family:"Arial";font-style:normal}.c13{background-color:#ffffff;max-width:648pt;padding:72pt 72pt 72pt 72pt}.c11{font-weight:400;font-size:26pt}.c12{font-size:15pt;font-weight:700}.c3{font-size:12pt;font-weight:700}.c4{font-size:12pt}.c8{font-style:italic}.c9{height:14pt}.c2{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c13 doc-content"><p class="c15 title" id="h.p9zebil4hzda"><span class="c7 c11">Project 3: Pathtracer</span></p><p class="c0"><span class="c5">Rohan Mathur and Joy Liu</span></p><h3 class="c6" id="h.p0dfuniokws0"><span class="c12">Overview</span><span class="c10">&nbsp;</span></h3><p class="c0"><span class="c1">In this project, we implemented various components of how light interacts with a scene and winds up in our camera sensor. We generated rays and determined whether they intersect with objects in the scene with different numbers of bounces. The process is accelerated using a bounding volume hierarchy that helps the algorithm run in logarithmic time with respect to the number of objects. The visual properties of the material are parametrized by how much light is reflected, and in what direction, using the bidirectional reflectance distribution function. </span></p><p class="c0 c2"><span class="c1"></span></p><hr style="page-break-before:always;display:none;"><h3 class="c6 c9" id="h.m6t6ilgjwln"><span class="c10"></span></h3><h3 class="c6" id="h.vqhh7ld4fmoo"><span class="c10">Part 1 Ray Generation and Scene Intersection </span></h3><p class="c0"><span class="c1">Given a fixed camera position and field of view, the ray is defined by the image coordinate it pierces. Since the width and height of the sensor are a function of the full field of view, we can scale the field of view by the normalized image coordinates to determine the coordinates in camera space. Finally, we normalize this direction and convert to world space. </span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">For triangle intersection, we used the Moller Trumbore equation, which sets up a linear system of equations to solve for the barycentric coordinates and the point on the ray, t. If this t is within the end points of the ray and the barycentric coordinates are all between 0 and 1, then the ray intersects with the triangle. </span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">For sphere intersection, we set up a quadratic equation to solve for the point on the ray, t, that intersects with the sphere. If there are two solutions, then the ray goes through the sphere, if there is one, then the ray is tangent to the sphere, and there could also be no intersections at all.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 421.50px; height: 316.13px;"><img alt="" src="images/image40.png" style="width: 421.50px; height: 316.13px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 416.00px; height: 312.00px;"><img alt="" src="images/image16.png" style="width: 416.00px; height: 312.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 412.67px; height: 309.50px;"><img alt="" src="images/image30.png" style="width: 412.67px; height: 309.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span class="c1"></span></p><hr style="page-break-before:always;display:none;"><h3 class="c6 c9" id="h.bb4akqu3i0p"><span class="c10"></span></h3><h3 class="c6" id="h.b2y2hlwp1jo9"><span class="c10">Part 2 BVH</span></h3><p class="c0"><span class="c1">Our BVH heuristic goes through object centroids and determines which axis has the highest range of values. Then we split using the midpoint between the minimum and maximum values on this axis. </span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Our BVH construction algorithm takes in a list of primitives and initializes a current node. It first calculates the bounding box for the current node by getting the maximum and minimum values for all the primitives in the current list. If the number of elements is less than the maximum leaf size, we return this node as a leaf node with no children. If the number of elements exceeds the maximum leaf value, then we partition the primitives into left and right lists using our heuristic. The left and right children of the current node are created by recursively calling the BVH construction algorithm on the left and right lists respectively. </span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">The speedups are listed below: </span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 158.67px; height: 97.64px;"><img alt="" src="images/image3.png" style="width: 158.67px; height: 209.04px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 159.93px; height: 97.31px;"><img alt="" src="images/image3.png" style="width: 159.93px; height: 208.33px; margin-left: 0.00px; margin-top: -111.02px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Below are some images that can only be rendered with BVH acceleration: </span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 419.33px; height: 314.50px;"><img alt="" src="images/image36.png" style="width: 419.33px; height: 314.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 416.50px; height: 312.89px;"><img alt="" src="images/image14.png" style="width: 416.50px; height: 312.89px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 420.50px; height: 315.11px;"><img alt="" src="images/image2.png" style="width: 420.50px; height: 315.11px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><hr style="page-break-before:always;display:none;"></p><h3 class="c6" id="h.a02vtxufqtxg"><span class="c10">Part 3 Direct Illumination </span></h3><p class="c0"><span class="c1">Uniform hemisphere sampling: given a ray from the camera to the scene and the interaction point in the scene, we want to calculate what light hits this intersection point. To capture all the light, we would have to integrate over all incident rays that hit a point in the scene then travel to the camera. Because we cannot feasibly do this, we instead use Monte Carlo integration, where we average the values from different directions, weighted by the probability of picking that direction. </span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">We create an object coordinate system with respect to the normal direction of the surface at the intersection point, then sample random directions in the hemisphere around this vector. We convert this vector back to world space, and create a new ray that originates at the intersection point and travels in the sampled incident direction. We add this light to the outgoing light: the reflectance (BSDF property of the material at the intersection point) times the emission at the origin point, scaled using Lambert&rsquo;s cosine law, and normalized by the number of samples and the probability. &nbsp; </span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Importance sampling: because we know that the distribution of nonzero emission values are only directions of the light sources, we can sample from this distribution instead and get a very good fit. Given the ray from the camera and the intersection point in the scene, we iterate through the light sources, sample directions between the light sources and the intersection point, and add to the outgoing light if nothing blocks the light. In other words, if a ray originating at the light in the direction of the intersection point does not intersect with anything before the intersection point, we add to the outgoing light. This time, we also have to normalize by the probability of sampling this direction,which is no longer uniform. One optimization is that if the light source is a point light source, there is only one direction. </span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c7 c3">Hemisphere:</span></p><p class="c0"><span class="c1">s=16, l=8 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s=64, l=32 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s=16, l=8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s=64, l=32</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 200.50px; height: 150.38px;"><img alt="" src="images/image33.png" style="width: 200.50px; height: 150.38px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 202.50px; height: 150.08px;"><img alt="" src="images/image27.png" style="width: 202.50px; height: 150.08px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 200.50px; height: 149.33px;"><img alt="" src="images/image20.png" style="width: 200.50px; height: 149.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 204.50px; height: 151.33px;"><img alt="" src="images/image31.png" style="width: 204.50px; height: 151.33px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c7 c3">Importance:</span></p><p class="c0"><span class="c1">s=1, l=1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s=64, l=32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s=1, l=1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s=64, l=32</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 205.50px; height: 155.23px;"><img alt="" src="images/image4.png" style="width: 205.50px; height: 155.23px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 202.50px; height: 151.88px;"><img alt="" src="images/image25.png" style="width: 202.50px; height: 151.88px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 206.50px; height: 154.50px;"><img alt="" src="images/image34.png" style="width: 206.50px; height: 154.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 204.71px; height: 152.07px;"><img alt="" src="images/image5.png" style="width: 204.71px; height: 152.07px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span class="c3 c7"></span></p><p class="c0"><span class="c1">Comparing the images between hemisphere and importance sampling, we can see that the importance sampling reduces the variance of the Monte Carlo estimates. The shadows become much smoother, and the graininess goes down significantly. This is because the uniformly sampled rays have higher variance.</span></p><p class="c0 c2"><span class="c1"></span></p><hr style="page-break-before:always;display:none;"><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Rendering with 1, 4, 16, 64 light rays at 1 sample per pixel</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 342.27px; height: 254.17px;"><img alt="" src="images/image7.png" style="width: 342.27px; height: 254.17px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 342.50px; height: 256.12px;"><img alt="" src="images/image26.png" style="width: 342.50px; height: 256.12px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 353.50px; height: 264.61px;"><img alt="" src="images/image10.png" style="width: 353.50px; height: 264.61px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 329.50px; height: 265.49px;"><img alt="" src="images/image13.png" style="width: 329.50px; height: 326.12px; margin-left: 0.00px; margin-top: -24.92px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c4">We can see here that even at just one sample per pixel, increasing the light rays makes the render much cleaner.</span><hr style="page-break-before:always;display:none;"></p><h3 class="c6" id="h.d8leaaxmdjgr"><span class="c10">Part 4 Global Illumination</span></h3><p class="c0"><span class="c1">Global illumination recursively calls direct, one bounce illumination to add light that travels to the camera after multiple bounces. The recursive call is as if we pointed the camera to a point in the scene, then traveled to that point and reinstalled the camera there. </span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c4">Algorithmically, the recursive function takes in a ray with depth </span><span class="c4 c8">d </span><span class="c4">and an intersection. We start the depth attribute of the ray at maximum ray depth and decrement it with each recursive call. Our base case is the ray depth being 1, where we return the one bounce radiance. Otherwise, we initialize a ray in a random direction with depth </span><span class="c4 c8">d-1</span><span class="c4">&nbsp;and originating at the intersection point, and determine what it intersects with in the scene. We recursively call at least one bounce radiance on this new ray and intersection. If we accumulate bounces, we add in the direct lightning at each depth, otherwise we only return light at depth </span><span class="c4 c8 c14">d. </span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Only Direct:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 380.50px; height: 284.36px;"><img alt="" src="images/image28.png" style="width: 380.50px; height: 284.36px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span class="c1">Only indirect:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 378.50px; height: 283.32px;"><img alt="" src="images/image11.png" style="width: 378.50px; height: 283.32px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c4">Max Ray Depth at 0, 1, 2, 3, 4, 5 </span><span class="c3">without</span><span class="c1">&nbsp;accumulating bounces</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 268.50px; height: 201.38px;"><img alt="" src="images/image35.png" style="width: 268.50px; height: 201.38px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 269.50px; height: 201.06px;"><img alt="" src="images/image8.png" style="width: 269.50px; height: 201.06px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 270.50px; height: 202.07px;"><img alt="" src="images/image39.png" style="width: 270.50px; height: 202.07px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 270.50px; height: 202.19px;"><img alt="" src="images/image19.png" style="width: 270.50px; height: 202.19px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 266.15px; height: 199.95px;"><img alt="" src="images/image12.png" style="width: 266.15px; height: 199.95px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 268.50px; height: 200.87px;"><img alt="" src="images/image24.png" style="width: 268.50px; height: 200.87px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span class="c1"></span></p><hr style="page-break-before:always;display:none;"><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c4">Max Ray Depth at 0, 1, 2, 3, 4, 5 </span><span class="c3">with</span><span class="c1">&nbsp;accumulating bounces</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 280.90px; height: 209.66px;"><img alt="" src="images/image29.png" style="width: 280.90px; height: 209.66px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 281.50px; height: 210.87px;"><img alt="" src="images/image8.png" style="width: 281.50px; height: 210.87px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 286.50px; height: 213.84px;"><img alt="" src="images/image15.png" style="width: 286.50px; height: 213.84px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 285.99px; height: 211.81px;"><img alt="" src="images/image32.png" style="width: 285.99px; height: 211.81px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 277.63px; height: 206.81px;"><img alt="" src="images/image37.png" style="width: 277.63px; height: 206.81px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 285.50px; height: 212.29px;"><img alt="" src="images/image9.png" style="width: 285.50px; height: 212.29px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">We experienced a bug here that led the ground to have striped patterns. </span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Russian Roulette:</span></p><p class="c0"><span class="c1">We implemented Russian Roulette termination by flipping a coin with a probability of 0.4 of landing heads and if it did, terminating early. To adjust for the addition of this light, we normalize by the probability of terminating. The more unlikely it is to recursive to a very deep level, the more heavily we count this sample from the deep level. By terminating earlier, we can have a larger number of max bounces without very long runtimes..</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Russian Roulette Termination at 0, 1, 2, 3, 4, 100</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 280.50px; height: 210.38px;"><img alt="" src="images/image38.png" style="width: 280.50px; height: 210.38px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 283.50px; height: 211.86px;"><img alt="" src="images/image18.png" style="width: 283.50px; height: 211.86px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 284.50px; height: 212.88px;"><img alt="" src="images/image23.png" style="width: 284.50px; height: 212.88px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 283.50px; height: 210.40px;"><img alt="" src="images/image21.png" style="width: 283.50px; height: 210.40px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 279.85px; height: 207.69px;"><img alt="" src="images/image17.png" style="width: 279.85px; height: 207.69px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 284.50px; height: 211.84px;"><img alt="" src="images/image22.png" style="width: 284.50px; height: 211.84px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><hr style="page-break-before:always;display:none;"><p class="c0 c2"><span class="c1"></span></p><h3 class="c6" id="h.39k9uevy9hud"><span class="c10">Part 5 Adaptive Sampling </span></h3><p class="c0"><span class="c4">Adaptive sampling is sampling ray directions from a pixel until the change in illuminance is less than a certain threshold. We do this by defining a </span><span class="c4 c8">convergence</span><span class="c1">&nbsp;variable that is equal to a confidence interval that our Color value of the pixel is within 2 standard deviations of the optimally correct color value. Once that convergence value is less than a threshold multiplied by the mean, we stop taking more samples and move onto the next pixel. In our implementation, we iterate until either breaking due to termination or we hit a max number of samples. Each iteration, we add the illuminance of each sample&rsquo;s calculated color (so it can be a scalar instead of a Vector3D) to a sum variable and then the square of the illuminance to a sum squared variable. We use those variables to then compute the mean and variance of our collected illuminance values. Every 32 samples (or some other batch size) we calculate the convergence value and if it is within the threshold, we return early. We also update a sampleCountBuffer so we can visualize the different rates.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Non-adaptive:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image41.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Adaptive:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 480.00px; height: 360.00px;"><img alt="" src="images/image6.png" style="width: 480.00px; height: 360.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">As you can see, there is little to no difference in the pictures, but the adaptive sampling took much less time because it terminated early for the low variance pixels like the walls.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Sample rate:</span></p><p class="c0"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 375.88px; height: 280.57px;"><img alt="" src="images/image1.png" style="width: 375.88px; height: 280.57px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><div><p class="c0 c2"><span class="c5"></span></p></div></body></html>